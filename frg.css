import http.client
import json
import ssl

# Create a custom SSL context
context = ssl.create_default_context()
context.check_hostname = False
context.verify_mode = ssl.CERT_NONE

# Create connection with SSL context
conn = http.client.HTTPSConnection("10.50.66.58", 8081, context=context)

payload = json.dumps({
    "model": "model1",
    "prompt": "generate C code for linked lists",
    "max_tokens": 256,
    "min_tokens": 128
})

headers = {
    'Content-Type': 'application/json'
}

try:
    conn.request("POST", "/v1/completions", payload, headers)
    res = conn.getresponse()
    data = res.read()
    print(data.decode("utf-8"))
except Exception as e:
    print(f"Error occurred: {str(e)}")
finally:
    conn.close()